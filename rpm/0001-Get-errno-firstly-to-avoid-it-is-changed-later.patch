From 8aa677a1482dd3ef7701ac1508fa39f3838e7aea Mon Sep 17 00:00:00 2001
From: Anas Nashif <anas.nashif@intel.com>
Date: Sun, 9 Dec 2012 13:46:25 -0800
Subject: [PATCH 1/6] Get errno firstly to avoid it is changed later

---
 src/drivers/driver_wext.c |    2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

diff --git a/src/drivers/driver_wext.c b/src/drivers/driver_wext.c
index 9733e01..ab7f434 100644
--- a/src/drivers/driver_wext.c
+++ b/src/drivers/driver_wext.c
@@ -54,12 +54,12 @@ int wpa_driver_wext_set_auth_param(struct wpa_driver_wext_data *drv,
 	iwr.u.param.value = value;
 
 	if (ioctl(drv->ioctl_sock, SIOCSIWAUTH, &iwr) < 0) {
+		ret = errno == EOPNOTSUPP ? -2 : -1;
 		if (errno != EOPNOTSUPP) {
 			wpa_printf(MSG_DEBUG, "WEXT: SIOCSIWAUTH(param %d "
 				   "value 0x%x) failed: %s)",
 				   idx, value, strerror(errno));
 		}
-		ret = errno == EOPNOTSUPP ? -2 : -1;
 	}
 
 	return ret;
-- 
1.7.9.5

